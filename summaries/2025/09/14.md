# Activity Summary for 9/14/2025

## 2:05:10 PM
The log shows three revisions of the file `c:\Users\zhiha\MDP_Shared\MDP-Maxxing\RPI_Server\communication\spp_server.py` within a short time frame (approximately 20 minutes on September 14, 2025).  The core functionality remains consistent throughout all revisions: establishing a Bluetooth Serial Port Profile (SPP) server connection with an Android device, sending and receiving JSON-formatted messages.

The key changes are related to logging:

* **Initial Version (1:03:17 PM):**  Print statements are used for logging connection status and error handling.
* **Second Revision (1:03:57 PM):**  The `AndroidMessage` class is modified to include a logger instance (`self.logger = prepare_logger()`), and all print statements are replaced with calls to the logger for both informational and error messages.  This is a significant improvement for debugging and monitoring.
* **Third Revision (1:04:30 PM):** The logger instantiation is moved from the `AndroidMessage` class to the `AndroidLink` class.  This is a minor change, logically placing the logger with the class responsible for the Bluetooth connection.

No other significant code changes are observed across the three versions.  The Bluetooth connection setup, message handling (sending and receiving), and error handling remain largely the same. The pattern shows a progressive improvement in the code's logging mechanism, replacing basic print statements with a more robust logging framework.


## 3:05:10 PM
The code implements a Raspberry Pi server (`Week8.py`) that communicates with an Android device and potentially an STM32 microcontroller (though STM32 integration is noted as TODO).  The communication with the Android device uses Bluetooth SPP (`spp_server.py`).

`spp_server.py` (updated 9/14/2025, 2:07:16 PM) defines classes for handling Bluetooth communication: `AndroidMessage` for structuring messages and `AndroidLink` for establishing and managing the Bluetooth connection.  `AndroidLink` includes methods for connecting, disconnecting, sending, and receiving JSON-formatted messages.  The code uses the `bluetooth` library and includes error handling for connection and communication issues.  The SPP UUID is defined as "94f39d29-7d6d-437d-973b-fba39e49d4ee".

`Week8.py` (updated 9/14/2025, 3:03:15 PM) is the main program, setting up a multi-process architecture using `multiprocessing`.  It uses `AndroidLink` from `spp_server.py` to communicate with Android.  The code manages queues for sending and receiving messages to/from Android and (planned) STM32.  The `android_io_process` function handles the Bluetooth connection and spawns threads for sending (`send_android`) and receiving (`recv_android`) messages.  Message handling includes parsing JSON data and routing commands based on message category ('sendArena' for obstacle data, 'stm' for robot control).  A `test_android` function simulates sending various test messages to Android.  The code also incorporates error handling, logging (`logger` module), and a reconnection mechanism (`reconnect_android`).  The use of `Manager` suggests shared memory is used for inter-process communication.  The program defines classes for managing actions (`PiAction`) and the overall Raspberry Pi state (`RaspberryPi`).  There is a significant amount of error handling throughout the code.  The program starts by initializing these processes and the main loop remains in listening mode.
